<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>One Stop Compliance – RepairScope Platform (Confidential Pilot)</title>

    <style>
      :root {
        --bg: #fafafa;
        --card: #ffffff;
        --text: #111111;
        --muted: #666666;
        --border: #e6e6e6;
        --shadow: 0 1px 0 rgba(0, 0, 0, 0.03);
        --pill: #f2f2f2;
        --danger: #b42318;
        --ok: #067647;
      }

      * { box-sizing: border-box; }
      body {
        margin: 0;
        font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
        background: var(--bg);
        color: var(--text);
      }

      .container {
        max-width: 900px;
        margin: 0 auto;
        padding: 16px;
        padding-bottom: 104px; /* room for bottom nav */
      }

      .topbar {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 12px;
        padding: 14px;
        border: 1px solid var(--border);
        border-radius: 18px;
        background: var(--card);
        box-shadow: var(--shadow);
      }

      .brand {
        display: flex;
        align-items: center;
        gap: 12px;
        min-width: 0;
      }

      .brand img {
        height: 56px;
        width: auto;
        object-fit: contain;
        display: block;
      }

      .brand-text { min-width: 0; }
      .confidential {
        font-size: 12px;
        color: var(--muted);
      }
      .title {
        font-size: 22px;
        font-weight: 800;
        line-height: 1.1;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        max-width: 520px;
      }
      .subtitle {
        font-size: 14px;
        color: var(--muted);
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        max-width: 520px;
      }

      .pill {
        font-size: 12px;
        font-weight: 800;
        padding: 6px 10px;
        border-radius: 999px;
        border: 1px solid var(--border);
        background: var(--pill);
        white-space: nowrap;
      }

      .grid {
        display: grid;
        gap: 12px;
        margin-top: 14px;
      }
      .grid.kpis {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }
      @media (min-width: 720px) {
        .grid.kpis {
          grid-template-columns: repeat(4, minmax(0, 1fr));
        }
      }

      .card {
        border: 1px solid var(--border);
        border-radius: 18px;
        background: var(--card);
        box-shadow: var(--shadow);
        padding: 14px;
      }

      .kpi-label {
        font-size: 12px;
        color: var(--muted);
      }
      .kpi-value {
        font-size: 26px;
        font-weight: 900;
        margin-top: 2px;
      }

      .section-title {
        font-size: 14px;
        font-weight: 800;
        margin: 0 0 10px 0;
      }

      .claim {
        width: 100%;
        text-align: left;
        border: 1px solid var(--border);
        border-radius: 16px;
        padding: 12px;
        background: #fff;
        cursor: pointer;
      }
      .claim:active { transform: scale(0.99); }
      .claim-row {
        display: flex;
        align-items: flex-start;
        justify-content: space-between;
        gap: 10px;
      }
      .claim-id { font-weight: 800; }
      .claim-muted {
        font-size: 12px;
        color: var(--muted);
        margin-top: 2px;
      }
      .claim-next {
        font-size: 13px;
        margin-top: 8px;
        color: #222;
      }

      .status {
        font-size: 11px;
        font-weight: 800;
        border: 1px solid var(--border);
        border-radius: 999px;
        padding: 6px 10px;
        background: var(--pill);
        white-space: nowrap;
      }

      .actions {
        display: grid;
        grid-template-columns: repeat(2, minmax(0, 1fr));
        gap: 10px;
        margin-top: 12px;
      }
      .btn {
        border: 0;
        border-radius: 16px;
        padding: 12px 14px;
        font-weight: 800;
        cursor: pointer;
      }
      .btn-primary { background: #111; color: #fff; }
      .btn-outline { background: #fff; border: 1px solid var(--border); color: #111; }
      .btn-danger { background: var(--danger); color: #fff; }
      .hidden { display: none !important; }

      .tiny {
        font-size: 12px;
        color: var(--muted);
        margin-top: 10px;
      }

      /* Bottom nav (mobile friendly) */
      .bottom-nav {
        position: fixed;
        left: 0;
        right: 0;
        bottom: 0;
        background: #fff;
        border-top: 1px solid var(--border);
        padding: 8px;
      }
      .bottom-nav-inner {
        max-width: 900px;
        margin: 0 auto;
        display: grid;
        grid-template-columns: repeat(4, minmax(0, 1fr));
        gap: 8px;
      }
      .nav-btn {
        border: 0;
        border-radius: 16px;
        padding: 10px 8px;
        background: #fff;
        border: 1px solid transparent;
        font-weight: 800;
        font-size: 12px;
        color: #222;
      }
      .nav-btn.active { background: #111; color: #fff; }

      footer {
        margin-top: 18px;
        padding-top: 12px;
        border-top: 1px solid var(--border);
        font-size: 12px;
        color: var(--muted);
        text-align: center;
      }

      /* Modal */
      .modal-overlay {
        position: fixed;
        inset: 0;
        background: rgba(0,0,0,0.45);
        display: flex;
        align-items: flex-end;
        justify-content: center;
        padding: 10px;
        z-index: 9999;
      }
      @media (min-width: 720px) {
        .modal-overlay { align-items: center; }
      }
      .modal {
        width: 100%;
        max-width: 560px;
        background: #fff;
        border-radius: 20px;
        border: 1px solid var(--border);
        box-shadow: 0 20px 60px rgba(0,0,0,0.18);
        overflow: hidden;
      }
      .modal-header {
        padding: 14px 14px 10px 14px;
        border-bottom: 1px solid var(--border);
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 10px;
      }
      .modal-title {
        font-size: 16px;
        font-weight: 900;
      }
      .modal-close {
        border: 0;
        background: #fff;
        border-radius: 12px;
        padding: 8px 10px;
        font-weight: 900;
        cursor: pointer;
      }
      .modal-body { padding: 14px; }
      .field-label {
        font-size: 12px;
        font-weight: 800;
        margin-bottom: 6px;
      }
      .input {
        width: 100%;
        padding: 12px 12px;
        border-radius: 14px;
        border: 1px solid var(--border);
        font-size: 14px;
      }
      .help {
        font-size: 12px;
        color: var(--muted);
        margin-top: 8px;
        line-height: 1.35;
      }
      .modal-footer {
        padding: 12px 14px 14px 14px;
        border-top: 1px solid var(--border);
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 10px;
      }

      .badge-row {
        margin-top: 10px;
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
      }
      .badge {
        font-size: 12px;
        font-weight: 900;
        border: 1px solid var(--border);
        border-radius: 999px;
        padding: 6px 10px;
        background: #fff;
      }
      .badge.ok { border-color: rgba(6,118,71,0.35); background: rgba(6,118,71,0.08); color: var(--ok); }
      .badge.warn { border-color: rgba(180,35,24,0.35); background: rgba(180,35,24,0.08); color: var(--danger); }

      .log {
        margin-top: 10px;
        border: 1px solid var(--border);
        border-radius: 14px;
        padding: 10px;
        background: #fff;
      }
      .log-title { font-size: 12px; font-weight: 900; margin-bottom: 6px; }
      .log-item { font-size: 12px; color: #222; padding: 6px 0; border-top: 1px dashed #eee; }
      .log-item:first-child { border-top: 0; }
      .log-time { color: var(--muted); font-size: 11px; }
    </style>
  </head>

  <body>
    <div class="container">
      <!-- HEADER / BRAND -->
      <div class="topbar">
        <div class="brand">
          <!-- ✅ YOUR LOGO: must be same folder as index.html -->
          <img
            src="Onestop7.png"
            alt="One Stop Compliance – RepairScope Platform"
            onerror="document.getElementById('logoFallback').classList.remove('hidden'); this.classList.add('hidden');"
          />
          <div id="logoFallback" class="hidden" style="font-weight:900; font-size:18px;">
            One Stop Compliance
          </div>

          <div class="brand-text">
            <div class="confidential">Confidential Pilot</div>
            <div class="title">One Stop Compliance</div>
            <div class="subtitle">RepairScope Platform</div>
          </div>
        </div>

        <div class="pill">MPI</div>
      </div>

      <!-- KPI CARDS -->
      <div class="grid kpis">
        <div class="card">
          <div class="kpi-label">Open claims</div>
          <div class="kpi-value" id="kpiTotal">3</div>
        </div>
        <div class="card">
          <div class="kpi-label">Needs action</div>
          <div class="kpi-value" id="kpiNeeds">3</div>
        </div>
        <div class="card">
          <div class="kpi-label">Waiting MPI</div>
          <div class="kpi-value" id="kpiMpi">1</div>
        </div>
        <div class="card">
          <div class="kpi-label">Waiting parts</div>
          <div class="kpi-value" id="kpiParts">1</div>
        </div>
      </div>

      <!-- DASHBOARD LIST -->
      <div class="card" id="dashboardCard">
        <h3 class="section-title">Top priority claims</h3>

        <button class="claim" onclick="openClaims()">
          <div class="claim-row">
            <div>
              <div class="claim-id">MPI-1023481</div>
              <div class="claim-muted">2022 Ford F-150 • RO-7712</div>
              <div class="claim-muted">Last activity: <span id="t1"></span></div>
            </div>
            <div class="status">Waiting Approval</div>
          </div>
          <div class="claim-next"><b>Next:</b> Enter MPI verbal auth code + proof; Admin approve OEM delta</div>
        </button>

        <div style="height:10px"></div>

        <button class="claim" onclick="openClaims()">
          <div class="claim-row">
            <div>
              <div class="claim-id">MPI-1023559</div>
              <div class="claim-muted">2019 Honda CR-V • RO-7720</div>
              <div class="claim-muted">Last activity: <span id="t2"></span></div>
            </div>
            <div class="status">Waiting Parts</div>
          </div>
          <div class="claim-next"><b>Next:</b> Get ETA update; notify customer</div>
        </button>

        <div style="height:10px"></div>

        <button class="claim" onclick="openClaims()">
          <div class="claim-row">
            <div>
              <div class="claim-id">MPI-1023602</div>
              <div class="claim-muted">2021 Toyota RAV4 • RO-7731</div>
              <div class="claim-muted">Last activity: <span id="t3"></span></div>
            </div>
            <div class="status">Planning</div>
          </div>
          <div class="claim-next"><b>Next:</b> Issue materials from stock or order seam sealer</div>
        </button>

        <div class="tiny">
          Production intent: encrypted data + role-based access + full audit logging (every action time/date stamped).
        </div>
      </div>

      <!-- CLAIMS VIEW -->
      <div class="card hidden" id="claimsCard">
        <h3 class="section-title">Claims (Pilot Demo)</h3>

        <div class="badge-row">
          <span class="badge warn" id="authBadge">MPI Verbal Auth: Not recorded</span>
          <span class="badge" id="portalBadge">MPI Portal: Not opened</span>
        </div>

        <div class="actions">
          <button class="btn btn-primary" onclick="openDashboard()">Back to Dashboard</button>

          <button class="btn btn-outline" onclick="openMPIPortal()">
            Open MPI Portal
          </button>

          <button class="btn btn-outline" onclick="openAuthModal()">
            Enter MPI Authorization Code
          </button>

          <button class="btn btn-outline" onclick="openChecklist()">
            Open Checklist
          </button>
        </div>

        <div class="log" id="auditLogBox">
          <div class="log-title">Audit Log (Demo Preview)</div>
          <div id="auditLog"></div>
        </div>

        <div class="tiny">
          Compliance note: MPI credentials are never stored or accessed by this platform. Portal opens in a separate session.
        </div>
      </div>

      <!-- CHECKLIST VIEW -->
      <div class="card hidden" id="checklistCard">
        <h3 class="section-title">MPI Checklist (Demo)</h3>
        <div style="color:#444; font-size:14px;">
          In production: tap-to-complete Records on File, attach photos and approvals, and maintain audit readiness.
        </div>

        <div class="actions">
          <button class="btn btn-primary" onclick="openDashboard()">Back to Dashboard</button>
          <button class="btn btn-outline" onclick="openAuthModal()">Enter MPI Authorization Code</button>
          <button class="btn btn-outline" onclick="openMPIPortal()">Open MPI Portal</button>
          <button class="btn btn-outline" onclick="alert('Demo: This would add tagged evidence and log the action with time/date.')">Add Evidence</button>
        </div>

        <div class="tiny">
          Enterprise default: Admin override requires reason and is fully logged.
        </div>
      </div>

      <!-- ADMIN VIEW -->
      <div class="card hidden" id="adminCard">
        <h3 class="section-title">Admin: Security & Audits (Demo)</h3>
        <div style="color:#444; font-size:14px;">
          In production: remote access control, MFA enforcement, accountant export windows, and insurer audit access termination on “Audit Completed”.
        </div>

        <div class="actions">
          <button class="btn btn-primary" onclick="openDashboard()">Back to Dashboard</button>
          <button class="btn btn-outline" onclick="alert('Demo: Audit Completed would invalidate access and notify the shop.')">Audit Completed</button>
          <button class="btn btn-outline" onclick="openMPIPortal()">Open MPI Portal</button>
          <button class="btn btn-outline" onclick="openAuthModal()">Enter MPI Authorization Code</button>
        </div>
      </div>

      <!-- COPYRIGHT / CONFIDENTIAL -->
      <footer>
        © 2026 Greg Evanochko & Brad Beckett<br />
        One Stop Compliance – RepairScope Platform<br />
        Confidential &amp; Proprietary
      </footer>
    </div>

    <!-- AUTH MODAL -->
    <div class="modal-overlay hidden" id="authModal" role="dialog" aria-modal="true" aria-label="MPI Authorization Code">
      <div class="modal">
        <div class="modal-header">
          <div>
            <div class="modal-title">MPI Verbal Authorization</div>
            <div class="confidential">Record the authorization code for audit trail.</div>
          </div>
          <button class="modal-close" onclick="closeAuthModal()">✕</button>
        </div>

        <div class="modal-body">
          <div class="field-label">MPI representative name</div>
          <input id="mpiRep" class="input" placeholder="e.g., Jane Doe" />

          <div style="height:12px;"></div>

          <div class="field-label">Authorization code</div>
          <input id="mpiAuthCode" class="input" placeholder="Enter code provided by MPI" />

          <div style="height:12px;"></div>

          <div class="field-label">Notes (optional)</div>
          <input id="mpiAuthNotes" class="input" placeholder="What was approved? (part, cost, reason)" />

          <div class="help">
            This records the code inside One Stop Compliance and logs the action with time/date.
            MPI credentials are not stored. For portal access, use the “Open MPI Portal” button.
          </div>
        </div>

        <div class="modal-footer">
          <button class="btn btn-outline" onclick="closeAuthModal()">Cancel</button>
          <button class="btn btn-primary" onclick="saveAuthCode()">Save</button>
        </div>
      </div>
    </div>

    <script>
      // --- Demo timestamps ---
      const now = Date.now();
      document.getElementById("t1").textContent = new Date(now - 1000 * 60 * 18).toLocaleString();
      document.getElementById("t2").textContent = new Date(now - 1000 * 60 * 75).toLocaleString();
      document.getElementById("t3").textContent = new Date(now - 1000 * 60 * 9).toLocaleString();

      // --- MPI portal URL (UPDATED) ---
      const MPI_PORTAL_URL = "https://mpipartners.ca/Login.aspx";

      // --- Simple demo state (stored locally) ---
      const STORAGE_KEY = "osc_demo_state_v1";
      const state = loadState();

      function loadState() {
        try {
          const raw = localStorage.getItem(STORAGE_KEY);
          if (!raw) return { mpiPortalOpenedAt: null, mpiAuth: null, auditLog: [] };
          return JSON.parse(raw);
        } catch {
          return { mpiPortalOpenedAt: null, mpiAuth: null, auditLog: [] };
        }
      }

      function saveState() {
        localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
      }

      function addLog(action, details) {
        const item = {
          at: new Date().toISOString(),
          action,
          details: details || ""
        };
        state.auditLog.unshift(item);
        state.auditLog = state.auditLog.slice(0, 12); // keep it short for demo
        saveState();
        renderBadges();
        renderLog();
      }

      // --- Navigation ---
      function setActiveNav(which) {
        const ids = ["navDashboard", "navClaims", "navChecklist", "navAdmin"];
        ids.forEach((id) => document.getElementById(id).classList.remove("active"));
        document.getElementById(which).classList.add("active");
      }

      function showOnly(cardId) {
        const cards = ["dashboardCard", "claimsCard", "checklistCard", "adminCard"];
        cards.forEach((id) => document.getElementById(id).classList.add("hidden"));
        document.getElementById(cardId).classList.remove("hidden");
        window.scrollTo({ top: 0, behavior: "smooth" });
      }

      function openDashboard() { setActiveNav("navDashboard"); showOnly("dashboardCard"); addLog("Viewed Dashboard"); }
      function openClaims() { setActiveNav("navClaims"); showOnly("claimsCard"); addLog("Viewed Claims"); }
      function openChecklist() { setActiveNav("navChecklist"); showOnly("checklistCard"); addLog("Viewed MPI Checklist"); }
      function openAdmin() { setActiveNav("navAdmin"); showOnly("adminCard"); addLog("Viewed Admin"); }

      // --- MPI Portal Button (safe outbound link) ---
      function openMPIPortal() {
        const confirmAccess = confirm(
          "You are about to leave One Stop Compliance and access the MPI system.\n\n" +
          "MPI credentials are not stored or accessed by this platform.\n" +
          "This action will be logged for audit purposes.\n\n" +
          "Continue?"
        );

        if (!confirmAccess) return;

        window.open(MPI_PORTAL_URL, "_blank", "noopener,noreferrer");
        state.mpiPortalOpenedAt = new Date().toISOString();
        saveState();
        addLog("Opened MPI Portal", MPI_PORTAL_URL);
      }

      // --- MPI Authorization Modal ---
      function openAuthModal() {
        document.getElementById("authModal").classList.remove("hidden");
        document.getElementById("mpiRep").focus();
        addLog("Opened MPI Authorization modal");
      }

      function closeAuthModal() {
        document.getElementById("authModal").classList.add("hidden");
        addLog("Closed MPI Authorization modal");
      }

      function saveAuthCode() {
        const rep = document.getElementById("mpiRep").value.trim();
        const code = document.getElementById("mpiAuthCode").value.trim();
        const notes = document.getElementById("mpiAuthNotes").value.trim();

        if (!code) {
          alert("Please enter the MPI authorization code.");
          return;
        }

        state.mpiAuth = {
          rep: rep || "MPI Rep (not entered)",
          code,
          notes: notes || "",
          at: new Date().toISOString()
        };

        saveState();
        addLog("Saved MPI Authorization Code", `Rep: ${state.mpiAuth.rep} • Code: ${mask(code)}`);
        closeAuthModal();
      }

      function mask(code) {
        // show last 3 chars only (demo-friendly privacy)
        if (!code) return "";
        const s = String(code);
        if (s.length <= 3) return "***";
        return "*".repeat(Math.max(3, s.length - 3)) + s.slice(-3);
      }

      // --- Render badges + audit log ---
      function renderBadges() {
        const authBadge = document.getElementById("authBadge");
        const portalBadge = document.getElementById("portalBadge");

        if (state.mpiAuth && state.mpiAuth.code) {
          authBadge.textContent = `MPI Verbal Auth: Recorded (${mask(state.mpiAuth.code)})`;
          authBadge.classList.remove("warn");
          authBadge.classList.add("ok");
        } else {
          authBadge.textContent = "MPI Verbal Auth: Not recorded";
          authBadge.classList.add("warn");
          authBadge.classList.remove("ok");
        }

        if (state.mpiPortalOpenedAt) {
          portalBadge.textContent = `MPI Portal: Opened (${new Date(state.mpiPortalOpenedAt).toLocaleString()})`;
          portalBadge.classList.add("ok");
        } else {
          portalBadge.textContent = "MPI Portal: Not opened";
          portalBadge.classList.remove("ok");
        }
      }

      function renderLog() {
        const el = document.getElementById("auditLog");
        if (!state.auditLog || state.auditLog.length === 0) {
          el.innerHTML = `<div class="log-item"><div>No events yet.</div><div class="log-time">Actions will appear here.</div></div>`;
          return;
        }

        el.innerHTML = state.auditLog
          .map((x) => {
            const t = new Date(x.at).toLocaleString();
            const d = x.details ? ` • ${escapeHtml(x.details)}` : "";
            return `<div class="log-item"><div><b>${escapeHtml(x.action)}</b>${d}</div><div class="log-time">${t}</div></div>`;
          })
          .join("");
      }

      function escapeHtml(str) {
        return String(str)
          .replaceAll("&", "&amp;")
          .replaceAll("<", "&lt;")
          .replaceAll(">", "&gt;")
          .replaceAll("\"", "&quot;")
          .replaceAll("'", "&#039;");
      }

      // --- Init ---
      renderBadges();
      renderLog();
      openDashboard();

      // Close modal if user taps outside it (mobile-friendly)
      document.getElementById("authModal").addEventListener("click", function(e) {
        if (e.target === this) closeAuthModal();
      });
    </script>

    <!-- BOTTOM NAV -->
    <div class="bottom-nav">
      <div class="bottom-nav-inner">
        <button id="navDashboard" class="nav-btn active" onclick="openDashboard()">Dashboard</button>
        <button id="navClaims" class="nav-btn" onclick="openClaims()">Claims</button>
        <button id="navChecklist" class="nav-btn" onclick="openChecklist()">Checklist</button>
        <button id="navAdmin" class="nav-btn" onclick="openAdmin()">Admin</button>
      </div>
    </div>
  </body>
</html>
```0
